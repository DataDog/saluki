optimization_goal: throughput
erratic: true
target:
  name: agent-data-plane
  command: /maybe-profile.sh /usr/local/bin/agent-data-plane --config /etc/agent-data-plane/empty.yaml run
  cpu_allotment: 4
  memory_allotment: 2GiB
  environment:
    DD_HOSTNAME: smp-regression
    DD_API_KEY: foo00000001
    DD_DD_URL: http://127.0.0.1:9091
    DD_IPC_CERT_FILE_PATH: /etc/agent-data-plane/cert.pem
    DD_LOG_FORMAT_JSON: "true"
    DD_DATA_PLANE_STANDALONE_MODE: "true"
    DD_DATA_PLANE_TELEMETRY_ENABLED: "true"
    DD_DATA_PLANE_TELEMETRY_LISTEN_ADDR: tcp://127.0.0.1:5102
    DD_DATA_PLANE_OTLP_ENABLED: "true"
    DD_OTLP_CONFIG: "{}"
  profiling_environment:
    SMP_PROFILING_ENABLED: "true"
    DD_SERVICE: agent-data-plane
    DD_TRACE_AGENT_URL: unix:///smp-host/apm.socket
    DD_PROFILING_NATIVE_PRESET: cpu_live_heap
    DD_PROFILING_INLINED_FUNCTIONS: "true"
report_links:
- text: (metrics)
  link: https://app.datadoghq.com/dashboard/4br-nxz-khi?fromUser=true&refresh_mode=paused&tpl_var_adp-run-id%5B0%5D={{ job_id
    }}&tpl_var_experiment%5B0%5D={{ experiment }}&view=spans&from_ts={{ start_time_ms }}&to_ts={{ end_time_ms }}&live=false
- text: (profiles)
  link: https://app.datadoghq.com/profiling/explorer?query=env%3Asingle-machine-performance%20service%3Aagent-data-plane%20job_id%3A{{
    job_id }}%20experiment%3A{{ experiment }}&agg_m=count&agg_m_source=base&agg_t=count&fromUser=false&viz=stream&start={{
    filter_start }}&end={{ filter_end }}&paused=true
- text: (logs)
  link: https://app.datadoghq.com/logs?query=experiment%3A{{ experiment }}%20run_id%3A{{ job_id }}&agg_m=count&agg_m_source=base&agg_q=%40span.url&agg_q_source=base&agg_t=count&fromUser=true&index=single-machine-performance-target-logs&messageDisplay=inline&refresh_mode=paused&storage=hot&stream_sort=time%2Cdesc&top_n=100&top_o=top&viz=stream&x_missing=true&from_ts={{
    filter_start }}&to_ts={{ filter_end }}&live=false
